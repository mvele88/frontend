<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>M & M A.I. PLATFORM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    .connected { color: #0f0; }
    .bot-active { color: #0ff; }
    button {
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      margin: 5px;
    }
    .log-entry { margin: 2px 0; }
    .log-timestamp { color: #666; }
  </style>
</head>
<body>
  <h1>M & M A.I. PLATFORM</h1>
  <div id="walletStatus">Wallet: Disconnected</div>
  <div id="botStatus">Bot offline</div>
  <div id="jupiterStatus">Jupiter Pro: Placeholder (Pro 1 key)</div>
  <button id="connectBtn">Connect Phantom</button>
  <button id="startBtn" disabled>Start Bot</button>
  <button id="stopBtn" disabled>Stop Bot</button>
  <div id="logsContainer"></div>

  <script src="https://unpkg.com/@solana/web3.js@1.73.2/lib/index.iife.js"></script>
  <script>
    let provider = null;
    let tradingInterval = null;
    let botActive = false;

    const connectBtn = document.getElementById("connectBtn");
    const startBtn = document.getElementById("startBtn");
    const stopBtn = document.getElementById("stopBtn");
    const walletStatus = document.getElementById("walletStatus");
    const botStatus = document.getElementById("botStatus");
    const jupiterStatus = document.getElementById("jupiterStatus");
    const logsContainer = document.getElementById("logsContainer");

    function addLog(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = 'log-entry';
      logEntry.innerHTML = `<span class="log-timestamp">[${timestamp}]</span> ${message}`;
      logsContainer.appendChild(logEntry);
      logsContainer.scrollTop = logsContainer.scrollHeight;
    }

    async function checkBalance() {
      const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"), "confirmed");
      const balance = await connection.getBalance(provider.publicKey);
      const sol = balance / 1e9;
      walletStatus.textContent = `Balance: ${sol.toFixed(4)} SOL`;
    }

    async function connectWallet() {
      if (!window.phantom || !window.phantom.solana || !window.phantom.solana.isPhantom) {
        alert("Phantom wallet not found.");
        return;
      }
      try {
        const resp = await window.phantom.solana.connect();
        provider = window.phantom.solana;
        connectBtn.textContent = "Connected";
        connectBtn.classList.add("connected");
        connectBtn.disabled = true;
        await checkBalance();
        startBtn.disabled = false;
        stopBtn.disabled = true;
        addLog(`Connected to wallet: ${resp.publicKey.toString()}`);
      } catch (err) {
        addLog(`Connection failed: ${err.message}`);
      }
    }

    connectBtn.addEventListener("click", connectWallet);

    startBtn.addEventListener("click", async () => {
      botActive = true;
      startBtn.disabled = true;
      stopBtn.disabled = false;
      botStatus.textContent = "Bot is actively trading!";
      botStatus.classList.add("bot-active");
      addLog("Bot started.");
      await fetch('https://crypto-backend-o3ekxoxzc-samuel-s-projects-545d58d6.vercel.app/start', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ wallet: provider.publicKey.toString() }),
      });
    });

    stopBtn.addEventListener("click", async () => {
      botActive = false;
      startBtn.disabled = false;
      stopBtn.disabled = true;
      botStatus.textContent = "Bot offline";
      botStatus.classList.remove("bot-active");
      addLog("Bot stopped.");
      await fetch('https://crypto-backend-o3ekxoxzc-samuel-s-projects-545d58d6.vercel.app/stop', {
        method: 'POST'
      });
    });
  </script>
</body>
</html>
